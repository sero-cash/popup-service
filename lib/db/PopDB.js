"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Table_1=require("./Table"),PopDB=function(){function e(e){var n=e.databaseName,t=e.tables;this.name=n,this.tables=t,this.createTable(this.tables)}return e.prototype.createDateBase=function(e,n){void 0===n&&(n=1),this.openedDB=indexedDB.open(e,n)},e.prototype.createTable=function(n,e){var o=this;void 0===e&&(e=1),indexedDB.open(this.name,e).onupgradeneeded=function(e){var t=e.target.result;n.forEach(function(e){if(!Array.from(t.objectStoreNames).includes(e.name)){var n=t.createObjectStore(e.name,{keyPath:e.keyPath,autoIncrement:e.autoIncrement});e.indexes.forEach(function(e){o.createIndex(n,e)})}})}},e.prototype.deleteTable=function(t,o){indexedDB.open(this.name,o).onupgradeneeded=function(e){var n=e.target.result;e.oldVersion<o&&n.deleteObjectStore(t)}},e.prototype.createIndex=function(e,n){var t={};n.unique&&(t.unique=n.unique),n.multiEntry&&(t.multiEntry=n.multiEntry),e.createIndex(n.index,n.relativeIndex,t)},e.prototype.connect=function(){var o=this;return new Promise(function(n,t){var e=indexedDB.open(o.name,o.version);e.onsuccess=function(e){n(e.target.result)},e.onerror=function(e){t(e)}})},e.prototype.close=function(){this.connect().then(function(e){e.close()})},e.prototype.insert=function(o,c){var e=this;return new Promise(function(n,t){e.connect().then(function(e){new Table_1.Table(o,e).insert(c).then(n).catch(t)})})},e.prototype.select=function(o,c){var e=this;return new Promise(function(n,t){e.connect().then(function(e){new Table_1.Table(o,e).select(c).then(function(e){n(e)}).catch(function(e){t(e)})})})},e.prototype.selectId=function(o,c){var e=this;return new Promise(function(n,t){e.connect().then(function(e){new Table_1.Table(o,e).selectId(c).then(function(e){n(e)}).catch(function(e){t(e)})})})},e.prototype.some=function(o,c,i){var e=this;return new Promise(function(n,t){e.connect().then(function(e){new Table_1.Table(o,e).some(c,i).then(function(e){n(e)}).catch(function(e){t(e)})})})},e.prototype.update=function(t,o){var c=this;return new Promise(function(n,e){c.connect().then(function(e){new Table_1.Table(t,e).update(o).then(function(e){n(e)}).catch(function(e){console.log(e),n(null)})})})},e.prototype.delete=function(t,o){var c=this;return new Promise(function(n,e){c.connect().then(function(e){new Table_1.Table(t,e).delete(o).then(function(e){n(e)}).catch(function(e){console.log(e),n(null)})})})},e.prototype.selectAll=function(o){var e=this;return new Promise(function(n,t){e.connect().then(function(e){new Table_1.Table(o,e).selectAll().then(function(e){n(e)}).catch(function(e){t(e)})})})},e.prototype.clearTable=function(o){var e=this;return new Promise(function(n,t){e.connect().then(function(e){new Table_1.Table(o,e).clear().then(function(e){n(e)}).catch(function(e){t(e)})})})},e}();exports.PopDB=PopDB;